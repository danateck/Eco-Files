<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EcoDocs Dashboard</title>

  <!-- פונט נקי ומודרני -->
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600&display=swap" rel="stylesheet" />

  <!-- ה-CSS הקיים שלך (בשביל הכרטיסי דוקומנטים, נוטיפיקציות, וכו') -->
  <link rel="stylesheet" href="./CSS/main.css" />

  <style>
    .doc-actions{margin-top:auto;display:flex;gap:.5rem;flex-wrap:wrap}
    .doc-action-btn{border:1px solid var(--border-soft);background:#fff;border-radius:6px;
      padding:.35rem .55rem;font-size:.7rem;cursor:pointer}
    .doc-action-btn.danger{border-color:#e7b3b3;color:#8a1f1f;background:#fff4f4}
    .doc-action-btn.restore{border-color:#a3d6c1;color:#1f5f4b;background:#eefaf4}

    :root {
      --bg-app: #f8fbf9;
      --bg-card: #ffffff;
      --bg-sidebar-from: #1e3b3b;
      --bg-sidebar-to: #2a5858;
      --border-soft: rgba(0,0,0,0.07);
      --text-dark: #1e3b3b;
      --text-mid: #4b6a60;
      --accent-soft: #cde8dc;
      --accent-strong: #2a5858;
      --radius-lg: 16px;
      --radius-md: 10px;
      --radius-sm: 6px;
      --shadow-card: 0 12px 32px rgba(0,0,0,0.08);
      --shadow-topbar: 0 2px 6px rgba(0,0,0,0.08);
      --shadow-btn: 0 6px 16px rgba(0,0,0,0.18);
      --grad-btn: linear-gradient(to right, #3a7f5d, #5dbb8d);
    }

    body {
      margin: 0;
      background: var(--bg-app);
      font-family: "Rubik", system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      color: var(--text-dark);
      display: flex;
      min-height: 100vh;
    }

    /* ====== LAYOUT ====== */
    .dashboard {
      display: flex;
      width: 100%;
      min-height: 100vh;
      position: relative;
    }

    /* ----- SIDEBAR ----- */
    .sidebar {
      width: 240px;
      background: linear-gradient(180deg, var(--bg-sidebar-from) 0%, var(--bg-sidebar-to) 100%);
      color: #fff;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 1rem 1rem 0.75rem;
      box-shadow: 4px 0 16px rgba(0,0,0,0.3);

      /* אנימציה/מעבר חלק */
      transition: transform .25s ease-in-out;
    }

    /* מצב מובייל: הופך למגירה נשלפת */
    @media (max-width: 760px) {
      .sidebar {
        position: fixed;
        top: 0;
        right: 0;
        height: 100vh;
        max-height: 100vh;
        width: 220px;
        max-width: 80%;
        box-shadow: 0 0 30px rgba(0,0,0,0.6);
        z-index: 9999;
        background: linear-gradient(180deg, var(--bg-sidebar-from) 0%, var(--bg-sidebar-to) 100%);

        /* מתחבא מחוץ למסך מצד ימין */
        transform: translateX(100%);
      }

      /* כשהוא פתוח */
      .sidebar.open {
        transform: translateX(0);
      }
    }

    .brand-block {
      display: flex;
      flex-direction: column;
      gap: .5rem;
      padding: .5rem .25rem 1rem;
      border-bottom: 1px solid rgba(255,255,255,0.12);
    }

    .brand-name {
      font-size: .9rem;
      font-weight: 600;
      color: #fff;
      letter-spacing: .03em;
      line-height: 1.2;
    }

    .brand-sub {
      font-size: .7rem;
      font-weight: 400;
      color: rgba(255,255,255,.7);
      line-height: 1.4;
    }

    .user-panel {
      margin-top: .75rem;
      background: rgba(255,255,255,0.07);
      border: 1px solid rgba(255,255,255,0.12);
      border-radius: var(--radius-md);
      padding: .6rem .75rem;
      font-size: .8rem;
      line-height: 1.4;
      color: #fff;
      display: flex;
      flex-direction: column;
      gap: .25rem;
    }

    .user-panel-name {
      font-weight: 500;
      color: #fff;
      font-size: .8rem;
    }

    .user-panel-mail {
      color: rgba(255,255,255,.7);
      font-size: .7rem;
      direction: ltr;
      unicode-bidi: plaintext;
      word-break: break-all;
    }

    nav.menu {
      display: flex;
      flex-direction: column;
      padding-top: 1rem;
      gap: .25rem;
    }

    .menu-label {
      color: rgba(255,255,255,.5);
      font-size: .7rem;
      font-weight: 500;
      letter-spacing: .05em;
      padding: 0 .5rem;
      margin-bottom: .25rem;
    }

    .menu-item {
      background: transparent;
      border: none;
      color: #fff;
      display: flex;
      align-items: center;
      gap: .6rem;
      padding: .6rem .5rem .6rem .75rem;
      border-radius: var(--radius-md);
      font-weight: 500;
      font-size: .8rem;
      cursor: pointer;
      text-align: right;
      width: 100%;
      transition: background .18s;
    }

    .menu-item:hover,
    .menu-item.active {
      background: rgba(255,255,255,0.12);
    }

    .menu-item-icon {
      width: 28px;
      height: 28px;
      border-radius: var(--radius-md);
      background: rgba(255,255,255,0.12);
      display: grid;
      place-items: center;
      font-size: .8rem;
      font-weight: 500;
    }

    .sidebar-bottom {
      border-top: 1px solid rgba(255,255,255,0.12);
      padding-top: .75rem;
      margin-top: 1rem;
    }

    .logout-btn {
      width: 100%;
      border: 0;
      border-radius: var(--radius-md);
      background: rgba(255,255,255,0.1);
      color: #fff;
      font-weight: 600;
      font-size: .8rem;
      padding: .6rem .75rem;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(0,0,0,.4);
      transition: background .18s, filter .18s;
    }
    .logout-btn:hover {
      background: rgba(255,255,255,0.18);
      filter: brightness(1.05);
    }

    /* ----- MAIN CONTENT WRAPPER ----- */
    .main-area {
      flex: 1;
      min-width: 0;
      display: flex;
      flex-direction: column;
      max-height: 100vh;
    }

    /* ----- TOP BAR ----- */
    .top-bar {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      align-items: center;
      background: #ffffff;
      padding: .8rem 1rem;
      box-shadow: var(--shadow-topbar);
      border-bottom: 1px solid var(--border-soft);
      z-index: 5;
    }

    .top-left {
      display: flex;
      flex-direction: column;
    }

    .page-title {
      margin: 0;
      font-size: .95rem;
      font-weight: 600;
      color: var(--text-dark);
      line-height: 1.3;
    }

    .page-sub {
      margin: 0;
      font-size: .7rem;
      color: var(--text-mid);
      line-height: 1.4;
    }

    .top-right {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: .5rem;
    }

    /* כפתור תפריט בנייד */
    .mobile-menu-btn {
      display: none; /* יופיע רק במסכים קטנים דרך media query */
      background: transparent;
      border: 1px solid var(--border-soft);
      border-radius: var(--radius-sm);
      font-size: 1rem;
      line-height: 1;
      padding: .4rem .6rem;
      cursor: pointer;
      color: var(--text-dark);
      background-color: #fff;
      box-shadow: 0 4px 10px rgba(0,0,0,.1);
    }

    .upload-btn {
      background: var(--grad-btn);
      color: #fff;
      border: 0;
      border-radius: var(--radius-md);
      font-size: .8rem;
      font-weight: 600;
      padding: .55rem .8rem;
      cursor: pointer;
      box-shadow: var(--shadow-btn);
      transition: filter .18s, transform .18s;
    }
    .upload-btn:hover {
      filter: brightness(1.05);
      transform: translateY(-1px);
    }

    .hidden-input {
      display: none;
    }

    /* ----- FILTER TABS ----- */
    .tabs-bar {
      background: #f6faf8;
      border-bottom: 1px solid #d6e6df;
      display: flex;
      flex-wrap: wrap;
      gap: .5rem;
      padding: .6rem 1rem;
    }

    .tab-btn {
      background: transparent;
      border: 0;
      border-radius: var(--radius-sm);
      font-size: .75rem;
      font-weight: 500;
      padding: .4rem .7rem;
      cursor: pointer;
      color: var(--text-dark);
      line-height: 1.2;
      transition: background .15s;
    }

    .tab-btn.active,
    .tab-btn:hover {
      background: var(--accent-soft);
      color: var(--accent-strong);
    }

    /* ----- MAIN CONTENT SECTIONS ----- */
    .content-scroll-area {
      flex: 1;
      min-height: 0;
      overflow-y: auto;
      padding: 1rem;
      display: grid;
      grid-template-rows: auto auto 1fr;
      row-gap: 1rem;
    }

    .home-view,
    .category-view {
      background: transparent;
      border-radius: var(--radius-lg);
    }

    .view-title {
      font-size: .9rem;
      font-weight: 600;
      color: var(--text-dark);
      margin: 0 0 .75rem;
      display: flex;
      align-items: center;
      gap: .5rem;
    }

    .folder-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(170px,1fr));
      gap: 1rem;
    }

    .folder-card {
      background: var(--bg-card);
      border: 1px solid var(--border-soft);
      border-radius: var(--radius-md);
      padding: .9rem .8rem;
      box-shadow: var(--shadow-card);
      cursor: pointer;
      display: flex;
      flex-direction: column;
      gap: .5rem;
      transition: transform .18s, box-shadow .18s;
      text-align: right;
    }

    .folder-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 16px 32px rgba(0,0,0,0.12);
    }

    .folder-icon {
      width: 40px;
      height: 32px;
      border-radius: 6px;
      background: linear-gradient(135deg,#ffe28a 0%,#ffc94d 100%);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
      position: relative;
    }
    .folder-icon::before {
      content: "";
      position: absolute;
      top: -6px;
      right: 4px;
      width: 18px;
      height: 8px;
      border-radius: 3px 3px 0 0;
      background: linear-gradient(135deg,#fff3b8 0%,#ffe694 100%);
      box-shadow: 0 3px 6px rgba(0,0,0,0.15);
    }

    .folder-label {
      font-size: .8rem;
      font-weight: 600;
      color: var(--text-dark);
      line-height: 1.3;
    }

    .category-view-header {
      display: flex;
      align-items: center;
      gap: .5rem;
      margin-bottom: .75rem;
    }

    .back-button {
      background: transparent;
      border: 1px solid var(--border-soft);
      border-radius: var(--radius-sm);
      padding: .4rem .6rem;
      font-size: .7rem;
      cursor: pointer;
      color: var(--accent-strong);
      background-color: #fff;
      transition: box-shadow .18s;
    }
    .back-button:hover {
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    }

    .category-title {
      font-size: .85rem;
      font-weight: 600;
      color: var(--text-dark);
      margin: 0;
    }

    .docs-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px,1fr));
      gap: 1rem;
    }

    .doc-card {
      background: var(--bg-card);
      border-radius: var(--radius-md);
      border: 1px solid var(--border-soft);
      box-shadow: var(--shadow-card);
      padding: .8rem .8rem .9rem;
      font-size: .8rem;
      line-height: 1.4;
      color: var(--text-dark);
      display: flex;
      flex-direction: column;
      gap: .5rem;
      min-height: 140px;
      position: relative;
    }

    .doc-card-title {
      font-weight: 600;
      font-size: .8rem;
      margin: 0;
      color: var(--text-dark);
    }

    .doc-card-meta {
      font-size: .7rem;
      color: var(--text-mid);
      line-height: 1.4;
      display: flex;
      flex-direction: column;
      gap: .25rem;
    }

    .doc-open-link {
      font-size: .75rem;
      font-weight: 500;
      color: var(--accent-strong);
      text-decoration: none;
      background: rgba(42,88,88,0.07);
      padding: .4rem .6rem;
      width: fit-content;
      border-radius: var(--radius-sm);
      box-shadow: 0 6px 14px rgba(0,0,0,0.08);
      transition: background .18s;
    }
    .doc-open-link:hover {
      background: rgba(42,88,88,0.12);
    }

    .notification {
      position: fixed;
      top: 1rem;
      left: 50%;
      transform: translateX(-50%) translateY(-10px);
      background-color: #0e3535;
      color: #fff;
      padding: 0.75rem 1rem;
      border-radius: 8px;
      font-size: 0.8rem;
      font-weight: 500;
      box-shadow: 0 12px 24px rgba(0,0,0,0.25);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 9999;
    }
    .notification.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
    .notification.error {
      background-color: #b63a3a;
    }
    .notification.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .hidden {
      display: none !important;
    }

    /* מובייל */
    @media (max-width: 760px) {
      .top-bar {
        border-radius: 0;
      }

      /* כפתור ההמבורגר נראה רק במובייל */
      .mobile-menu-btn {
        display: inline-block;
      }
    }

    /* בדסקטופ לא צריך את כפתור ההמבורגר */
    @media (min-width: 761px) {
      .mobile-menu-btn {
        display: none;
      }
    }



    /* Mobile logout button - visible only on small screens */
.mobile-logout {
  display: none;
}

@media (max-width: 760px) {
  .mobile-logout {
    display: inline-block;
    background: var(--grad-btn);
    border: none;
    border-radius: var(--radius-md);
    color: #fff;
    font-weight: 600;
    font-size: .8rem;
    padding: .55rem .9rem;
    cursor: pointer;
    box-shadow: var(--shadow-btn);
  }
}

  </style>
</head>

<body>
  <script>
    // אם אין יוזר מחובר - יזרוק לדף התחברות
    const currentUser = localStorage.getItem("docArchiveCurrentUser");
    if (!currentUser) {
      window.location.href = "./forms/eco-wellness/index.html";
    }
  </script>

  <div class="dashboard">
    <!-- ===== SIDEBAR ===== -->
    <aside class="sidebar" id="sidebarDrawer">
      <div>
        <div class="brand-block">
          <div class="brand-name">EcoDocs</div>
          <div class="brand-sub">ארכיון חכם • שמור • אישי</div>
        </div>

        <div class="user-panel">
          <div class="user-panel-name" id="currentUserLabel">שלום, משתמש!</div>
          <div class="user-panel-mail" id="currentUserEmail">user@example.com</div>
        </div>

        <nav class="menu">
          <div class="menu-label">ניווט</div>

          <button class="menu-item active" data-view="home">
            <div class="menu-item-icon">🏠</div>
            <span>דף הבית</span>
          </button>

          <button class="menu-item" data-view="shared">
            <div class="menu-item-icon">🤝</div>
            <span>אחסון משותף</span>
          </button>

          <button class="menu-item" data-view="recycle">
            <div class="menu-item-icon">🗑️</div>
            <span>סל מחזור</span>
          </button>
        </nav>
      </div>

      <div class="sidebar-bottom">
        <button class="logout-btn" id="logoutBtn">התנתקות</button>
      </div>
    </aside>

    <!-- ===== MAIN AREA ===== -->
    <section class="main-area">
      <!-- בר עליון -->
      <header class="top-bar">
        <div class="top-left">
          <h1 class="page-title">הארכיון שלי</h1>
          <p class="page-sub">כל המסמכים שלך במקום אחד</p>
        </div>

        <div class="top-right">
          <!-- כפתור פתיחה/סגירה של התפריט בנייד -->
          <button class="mobile-menu-btn" id="mobileMenuBtn">☰</button>
          <!-- Logout button for mobile -->
          <button class="logout-btn mobile-logout" id="mobileLogoutBtn">🚪 התנתקות</button>


          <button class="upload-btn" id="uploadBtn">📤 העלה מסמך</button>
          <input type="file" id="fileInput" class="hidden-input" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" />
        </div>
      </header>

      <!-- טאבים למיון -->
      <div class="tabs-bar">
        <button class="tab-btn active" data-sort="category">לפי קטגוריה</button>
        <button class="tab-btn" data-sort="year">לפי שנה</button>
        <button class="tab-btn" data-sort="org">לפי ארגון</button>
        <button class="tab-btn" data-sort="recipient">לפי נמען</button>
      </div>

      <!-- אזור התוכן -->
      <div class="content-scroll-area">
        <!-- מסך בית: כרטיסי תיקיות -->
        <section class="home-view" id="homeView">
          <h2 class="view-title">התיקיות שלך</h2>
          <div class="folder-grid" id="folderGrid"></div>
        </section>

        <!-- מסך קטגוריה -->
        <section class="category-view hidden" id="categoryView">
          <div class="category-view-header">
            <button class="back-button" id="backButton">⬅ חזרה</button>
            <h2 class="category-title" id="categoryTitle">שם תיקייה</h2>
          </div>

          <div class="docs-list" id="docsList"></div>
        </section>
      </div>
    </section>
  </div><!-- /dashboard -->

  <!-- התראות צפות -->
  <div id="notification" class="notification hidden"></div>

  <!-- סקריפט עזר בתוך הדף (רק דברים כלליים שאינם העלאה) -->
  <script>
    // ברוך הבא + המייל
    const label = document.getElementById("currentUserLabel");
    const mail = document.getElementById("currentUserEmail");
    const currentUserShown = localStorage.getItem("docArchiveCurrentUser");
    if (label) label.textContent = `שלום, ${currentUserShown}`;
    if (mail) mail.textContent = currentUserShown;

    // התנתקות
    const logoutBtn = document.getElementById("logoutBtn");
    if (logoutBtn) {
      logoutBtn.addEventListener("click", () => {
        localStorage.removeItem("docArchiveCurrentUser");
        window.location.href = "./forms/eco-wellness/index.html";
      });
    }

    // טאבים
    const tabs = document.querySelectorAll(".tab-btn");
    tabs.forEach(tab => {
      tab.addEventListener("click", () => {
        tabs.forEach(t => t.classList.remove("active"));
        tab.classList.add("active");
        // אפשר להוסיף פה מיון בעתיד
      });
    });

    // סיידבר – מעבר בין מסכים (בית / משותף / סל מחזור)
    const menuItems = document.querySelectorAll(".menu-item");
    const sidebarDrawer = document.getElementById("sidebarDrawer");
    menuItems.forEach(btn => {
      btn.addEventListener("click", () => {
        menuItems.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        const view = btn.dataset.view;
        if (view === "home") {
          window.App?.renderHome();
        } else if (view === "shared") {
          window.App?.openSharedView();
        } else if (view === "recycle") {
          window.App?.openRecycleView();
        }

        // במובייל - אחרי שבחרתי תפריט נסגור את הצד
        if (window.matchMedia("(max-width: 760px)").matches) {
          sidebarDrawer.classList.remove("open");
        }
      });
    });

    // כפתור ☰ במובייל לפתוח/לסגור את הסיידבר
    const mobileMenuBtn = document.getElementById("mobileMenuBtn");
    if (mobileMenuBtn) {
      mobileMenuBtn.addEventListener("click", () => {
        sidebarDrawer.classList.toggle("open");
      });
    }

    // Mobile logout
const mobileLogoutBtn = document.getElementById("mobileLogoutBtn");
if (mobileLogoutBtn) {
  mobileLogoutBtn.addEventListener("click", () => {
    localStorage.removeItem("docArchiveCurrentUser");
    window.location.href = "./forms/eco-wellness/index.html";
  });
}

  </script>

  <!-- הסקריפט הראשי של האפליקציה -->
  <script type="module" src="./JS/main.js"></script>
</body>
</html>
